\documentclass{article}

\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{dsfont}
\usepackage{bm}
\usepackage[a4paper, total={6in,8in}]{geometry}
\usepackage{graphicx}
\usepackage{float}
\usepackage{natbib}
\usepackage{hyperref}

\graphicspath{{figures/}}

\begin{document}

\title{A Two Mass Model}
\author{Will Woolfenden}

\section{A two-mass model}

\subsection{Formulating the model}

\begin{figure}
    \centering
    \includegraphics[width=\linewidth]{twomass_bothsides.jpeg}
    \caption{General illustration of the two-mass model. Plates with mass $\mathrm{m_1},\mathrm{m_2}$ are connected to the wall of the channel by springs.
    The fluid velocity $\bm{u(x)}$ and pressure $p$ are terms we can fix local to the lung.
    The stiffness coupling between masses provides a horizontal force which we ignore by restricting the masses to one-dimensional motion along the width of the channel.}
    \label{fig:twomass_bothsides}
\end{figure}

We will begin to construct a model for phonation involving two stiffness-coupled masses.
Due to symmetry, we will only consider one side of the channel, 
We consider a steady flow $\mathbf{u}$ passing through a channel,
in which two masses cause a constriction to the fluid passage.
Each mass $m_i$ is indivually supported by a spring with Hooke constant $k_i$,
and a coupling spring with constant $k_s$ connects the two masses.

We assume the masses to move one-dimensionally, perpendicular to the principal direction of the flow,
such that they may extend indefinitely.
We make the assumption that the fluid travels similar to a plug flow approximation,
in which the fluid velocity is constant across any cross-sectional area, % citation here - there's a text "fundamentals of fluid mechanics 9780471675822"
which ignores any potential stagnation or interference.
We also neglect external forces on the fluid, such as gravity.

Air is expelled from the lung and into the upper airway, before being released into the atmosphere.
We fix a pressure $p_0$ and velocity $U_0$ local to the lung.

The formal expression for conservation of mass can be expressed as

\begin{equation}
    \iiint_V \frac{\partial\rho}{\partial t}dV = \iint_S -\rho \bm{u\cdot n}~dS,
    \label{eqn:cons_mass_formal}
\end{equation}

which can be more formally understood as the rate of change of mass over volume $V$ begin equal to the rate at which fluid is transferred over the volume's surface $S$. 
The negative term comes from the convention of using the outer unit normal of a closed surface.
We will refer to the \textit{mass flux} at $A$, denoted $Q$, being the rate at which mass of fluid is transferred over an area $A$, or formally:

\begin{equation}
    Q(x) = -\iint_A \rho \bm{u \cdot n}~dS
\end{equation}

where $x$ is the position in the dominant direction of the flow, or equivalently $x$ is in the $\mathbf{n}$ direction.
The outer unit normal $\mathbf{n}$ is the vector pointing outwards normal to any cross-sectional area. 
The integral term is negative because the outer unit normal points in the direction opposite to the flow.

\begin{figure}
    \centering
    \includegraphics[width=\linewidth]{twomass_fluxpressure.jpeg}
    \caption{The single side of the model.
    Flux $Q$ is of interest on the boundaries between masses,
    and we can use flux to either deduce or assume relationships involving pressure and fluid velocity.
    }
    \label{fig:twomass_fluxpressure}
\end{figure}

We can find the flux $Q_0$, being the flux local to the lung, from the terms $U_0,~p_0$ which are defined in our initial conditions,

\begin{equation}
    Q(x_0) = -\iint_{A_0} \rho \bm{u}(x_0)\bm{\cdot n}(x_0)~dS.
\end{equation}

Since we have a condition $u(x=x_0) = U_0$, we can write this as

\begin{equation}
    Q(x_0) = \iint_{A_0} \rho U_0~dS.
\end{equation}

We have made the assumption of incompressibility in order to write $\rho$ as a constant.
Since $A_0$ is a cross-section of known area $\mathrm{wh}$, and $U_0$ is known, we have

\begin{equation}
    Q(x_0) = \rho wh U_0
    \label{eqn:twomass_lung_flux}
\end{equation}

by evaluating the integral of a uniform quantity $U_0$ over a surface $A_0$ as the quantity multiplied by the whole area.
The flux is not uniform, because we have regions of variable volume, and a varying flux local to these regions do not break assumptions of conservation of mass.
For example, if more fluid is entering a region than what is leaving, then the volume will increase.
We have flux $Q_{in}$ on the entry border of the two mass region, and $Q_{out}$ on the exit,
with $Q_{mid}$ on the plane in between the masses.

A volume $V_i$ has dimensions $h_i \mathrm{wd}$, where $h_i + b_i = \mathrm{h}$ for $i=1,2$.
The height $h_i$ is the only parameter that may vary, since we have granted a plate with position $b_i$ one dimensional motion.
We will take time derivatives:

\begin{equation}
    \dot{V_i} = \dot{h_i} w d.
\end{equation}

Conservation of mass \ref{eqn:cons_mass_formal} in combination with incompressibility tells us that the rate of change of a volume is equal to the rate at which its enclosed mass increases.
In volume $V_1$, mass enters through flux $Q_in$ and exits through flux $Q_mid$. The case for $V_2$ is analogous.
From this we can force an assumption to relate flux around a volume to its rate of change, which can be expressed as follows:

\begin{equation}
    \begin{aligned}
        \dot{h_1} w d &= Q_\mathrm{in} - Q_\mathrm{mid} \\
        \dot{h_2} w d &= Q_\mathrm{mid} - Q_\mathrm{out}.
    \end{aligned}
    \label{eqn:twomass_flux_motion}
\end{equation}

Since the lower airway region is fixed,
the flux $Q_0$ local to the lung is equal to the flux $Q_\mathrm{in}$ on the boundary of the lower mass,
and hence it is a known term. The fluid velocity $U_\mathrm{in}$ on the flux boundary can be deduced from conservation of mass in the lower airway, i.e.

\begin{equation}
    U_\mathrm{in} = \frac{Q_\mathrm{in}}{\mathrm{w}h_1}.
    \label{eqn:twomass_flux_in}
\end{equation}

However the terms $Q_\mathrm{mid}, Q_\mathrm{out}$ are not immediately known.
We will make the assumption that the fluid velocities in the respective volumes are determined by the flux,
where we take the average of the flux on the boundaries of a region of interest:

\begin{equation}
    \begin{aligned}
        U_1 &= \frac{1}{\mathrm{w}h_1}\left(\frac{Q_\mathrm{in} + Q_\mathrm{mid}}{2}\right) \\
        U_2 &= \frac{1}{\mathrm{w}h_2}\left(\frac{Q_\mathrm{mid} + Q_\mathrm{out}}{2}\right).
        \label{eqn:twomass_velocity_interpolation}
    \end{aligned}
\end{equation}

% We want to know the values of Q_mid and Q_out so we can interpolate
% what goes in must come out.

The regions of the model which represent the upper and lower airways are rigid fixed volumes equal in cross sectional area.
If mass is conserved, then the velocity $U_0$ and flux $Q_0$ local to the lung are equal to the velocity $U_\infty$ and flux $Q_\infty$ local to the vocal opening.
Using the same method as in Equation \ref{eqn:twomass_flux_in}, we have

\begin{equation}
    U_\mathrm{out} = \frac{Q_\mathrm{out}}{\mathrm{w}h_2},
    \label{eqn:twomass_flux_out}
\end{equation}

%% weve made the firm conservation of mass argument. This may not be true if the masses are moving,
% since the volume may be increasing so more fluid goes in than comes out.
% however there is a ceiling to how much the volume can increase

where the flux $Q_\mathrm{out}$ is equal to the opening flux $Q_\mathrm{\infty}$.

We have deduced several results on the velocity of the fluid through different locations in the model,
however we don't have explicit expressions for either the plate velocities or the fluxes,
which are the key values in our statements so far.

Recall Bernoulli's equation for a steady flow.
In order to evaluate an expression for the pressure in a region,
we need to know the fluid velocity, the body forces, and the local density.
Fortunately we have assumed incompressibility, so the density $\rho$ is constant,
and we choose to neglect body forces.
Along a streamline, we have:

\begin{equation}
    \begin{aligned}
        \frac{1}{2}\rho U_0^2 + \tilde{p}_0 &= \rho\mathrm{E} &\text{(lower airway)}\\
        \frac{1}{2}\rho U_1^2 + \tilde{p}_1 &= \rho\mathrm{E} &\text{(volume $V_1$)}  \\
        \frac{1}{2}\rho U_2^2 + \tilde{p}_2 &= \rho\mathrm{E} &\text{(volume $V_2$)}  \\
        \frac{1}{2}\rho U_\infty^2 + \tilde{p}_\infty &= \rho\mathrm{E} &\text{(upper airway)},
    \end{aligned}
\end{equation}

\noindent where $\mathrm{E}$ is the Bernoulli constant on the streamline.
We will later discuss the assumption of quasisteady flow in the model,
which justifies the application of Bernoulli's equation for a steady flow.
We can rearrange and obtain explicit expressions for pressure, being

\begin{equation}
    \begin{aligned}
        \tilde{p}_0 &= \rho\left(\mathrm{E} - \frac{1}{2}U_0^2\right) \\
        \tilde{p}_1 &= \rho\left(\mathrm{E} - \frac{1}{2}U_1^2\right) \\
        \tilde{p}_2 &= \rho\left(\mathrm{E} - \frac{1}{2}U_2^2\right) \\
        \tilde{p}_\infty &= \rho\left(\mathrm{E} - \frac{1}{2}U_\infty^2\right).
    \end{aligned}
\end{equation}

In the upper airway we have $\tilde{p}_\infty$ local to the vocal opening,
hence this is \textit{atmospheric pressure}, which we will write as \(\mathrm{\tilde{p}}\).
If we have zero fluid velocity local to the lung, and the fluid is driven by the pressure,
we have that $\tilde{p}_0 = \rho \mathrm{E}$,
and if $\tilde{p}_\infty$ is atmospheric pressure, then $\rho(\mathrm{E} - U_\infty^2/2) = 0$
In combination:

\begin{equation}
    \tilde{p}_0 = \rho \mathrm{E} = \frac{\rho U_\infty^2}{2}
\end{equation}


In the regions of interest, we are concerned with the difference in pressure from atmospheric level,
which are the pressure values we actually wish to compute.
We express the pressure terms as follows:

\begin{equation}
    \begin{aligned}
        p_0 &= \rho\mathrm{E} - \rho\frac{1}{2}U_0^2 - \rho\mathrm{E} + \frac{1}{2}U_\infty^2 = \frac{1}{2}\rho\left(U_\infty^2 - U_0^2\right) \\
        p_1 &= \frac{1}{2}\rho\left(U_\infty^2 - U_1^2\right) \\
        p_2 &= \frac{1}{2}\rho\left(U_\infty^2 - U_2^2\right).
    \end{aligned}
\end{equation}

\noindent Importantly \(p_0 = \tilde{p}_0\) is still the forcing term.

%now we're really in a pickle. How can we have atmospheric pressure when we can force pressure?

We now impose the assumtion of a quasisteady flow.
This lets us regard a consistent flux $Q$ throughout the mechanics,
rather than separate fluxes at different regions of interest.
Equations \ref{eqn:twomass_flux_in}, \ref{eqn:twomass_flux_out} give us an expression for velocity in terms of flux and the channel dimensions,
which we can generalise outside the region of interest:

\begin{equation}
    U = \frac{Q}{\mathrm{wh}},
\end{equation}

\noindent and in a region of interest we use the variable channel height instead

\begin{equation}
    U_i = \frac{Q}{\mathrm{w}h_i}
\end{equation}

\noindent for \(i=1,2\).

We now have a construction for pressure in terms of the plate displacement, thus can write the pressure-induced force on the plate.
Given \(i=1,2:\)

\begin{equation}
    \begin{aligned}
        p_i &= \rho\left(\mathrm{E} - \frac{1}{2}U_i^2 \right) \\
        &= \frac{1}{2}\rho\left(U_\infty^2 - U_i^2\right) \\
        &= \frac{1}{2}\rho\left( \left(\frac{Q}{\mathrm{wh}}\right)^2 - \left(\frac{Q}{\mathrm{w}h_i}\right)^2 \right) \\
        &= \frac{\rho Q^2}{\mathrm{w}^2}\left( \frac{1}{\mathrm{h}^2} - \frac{1}{h_i^2} \right)
    \end{aligned}
    \label{eqn:twomass_pressureterm}
\end{equation}

\begin{figure}
    \centering
    \includegraphics[width=\linewidth]{twomass_springs.jpeg}
    \caption
    {
        Illustration of the lengths $b_1,b_2$ and the springs connected to the masses.
        The springs connected to the wall act as support,
        preventing the Bernoulli pressure drop from forcing the walls into closure similarly to the single mass model.
        The coupling spring provides a stiffness such that the two masses can be thought of as one body consisting of two components.
        The springs allow us to deduce forces acting on the masses which stimulate motion by Newton's second law. 
    }
    \label{fig:twomass_springs}
\end{figure}

We use linear elastic Hooke springs to model the stiffness of the walls.
Support springs are similar to the original model we have considered,
however we now introduce stiffness coupling between two separate walls.
A plate $i = 1,2$ is connected to the wall by a stiffness spring with constant ${k}_i$.
The coupling spring has constant $\mathrm{k}_s$, and the resting equilibrium positions of all springs are at $0$.

The forces on a plate with position $b_i$ provide the equation of motion by Newton's second law:

\begin{equation}
    \mathrm{m}_i\frac{\mathrm{d}^2 b_i}{\mathrm{d}t^2} = -F_\mathrm{stiffness} - F_\mathrm{pressure} + F_\mathrm{coupling}
\end{equation}

\noindent for $i=1,2$. In full:

\begin{equation}
    \begin{aligned}
        \mathrm{m}_1\frac{\mathrm{d}^2 b_1}{\mathrm{d}t^2} &= -\mathrm{k}_1(b_1 - \mathrm{b}*) - \frac{wd\rho Q^2}{w^2}\left(\frac{1}{\mathrm{h}^2} - \frac{1}{(\mathrm{h}-b_1)^2} \right) + \mathrm{k}_s(b_2-b_1) \\
        \mathrm{m}_2\frac{\mathrm{d}^2 b_2}{\mathrm{d}t^2} &= -\mathrm{k}_1(b_2 - \mathrm{b}*) - \frac{wd\rho Q^2}{w^2}\left(\frac{1}{\mathrm{h}^2} - \frac{1}{(\mathrm{h}-b_2)^2} \right) + \mathrm{k}_s(b_1-b_2)
    \end{aligned}
\end{equation}

\noindent where $b*$ is the resting position of both masses. It will be easier to make $h$ the variable of interest, since closure at $h=0$ is identifiable,
and we will impose the resting position to be $h* = \mathrm{h}$. Recall the definition $b_i + h_i = \mathrm{h}$. The conversion yields

\begin{equation}
    \begin{aligned}
        \mathrm{m}_1\frac{\mathrm{d}^2 h_1}{\mathrm{d}t^2} &= -\mathrm{k}_1(h_1 - \mathrm{h}) + \frac{wd\rho Q^2}{w^2}\left(\frac{1}{\mathrm{h}^2} - \frac{1}{h_1^2} \right) + \mathrm{k}_s(h_2-h_1) \\
        \mathrm{m}_2\frac{\mathrm{d}^2 h_2}{\mathrm{d}t^2} &= -\mathrm{k}_2(h_2 - \mathrm{h}) + \frac{wd\rho Q^2}{w^2}\left(\frac{1}{\mathrm{h}^2} - \frac{1}{h_2^2} \right) + \mathrm{k}_s(h_1-h_2).
    \end{aligned}
\end{equation}

We introduce the following parameters

\begin{equation*}
    \begin{aligned}
        h_1 = \mathrm{h}\tilde{h}_1,~h_2 = \mathrm{h}\tilde{h}_2,~t=\sqrt{\frac{\mathrm{m}_1}{\mathrm{k}_1}}\tilde{t}, \\
        \alpha = \frac{\mathrm{m}_2}{\mathrm{m}_1},~\lambda = \frac{\mathrm{k}_2}{\mathrm{k}_1},~\omega = \frac{\mathrm{k}_s}{\mathrm{k}_1} \\
        \beta = \frac{\mathrm{wd}\rho U_\infty^2}{2\mathrm{k}_1\mathrm{h}}
    \end{aligned}
\end{equation*}

and the coupled fourth-order system of differential equations can be reduced to the nondimensional problem:

\begin{equation}
    \begin{aligned}
        \frac{\mathrm{d}^2 \tilde{h}_1}{\mathrm{d}\tilde{t}^2} &= 1 - \tilde{h}_1 + \beta \left( 1 - \frac{1}{\tilde{h}_1^2} \right) + \omega(\tilde{h}_2-\tilde{h}_1) \\
        \alpha\frac{\mathrm{d}^2 \tilde{h}_2}{\mathrm{d}\tilde{t}^2} &= \lambda(1 - \tilde{h}_2) + \beta \left( 1 - \frac{1}{\tilde{h}_2^2} \right) + \omega(\tilde{h}_1-\tilde{h}_2).
    \end{aligned}
    \label{eqn:twomass_master_system}
\end{equation}

The two mass generalises the concepts from the original model we investigated,
and maintains a lot of important features.
Before investigating the behaviour of the coupled system of equations,
we will verify that the new model can reproduce behaviours we have already seen.
Namely, if we were to configure the problem as two equal masses with the same stiffness,
and a strong coupling between them,
then we would expect the oscillating behaviour of the original model to be replicated.
We will then reduce the stiffness coupling and introduce different lateral stiffnesses for each mass,
investigating how the oscillating components affect one another in a coupled system.
Finally if we reduce the coupling to a negligible amount,
we would then expect the masses to behave near independently.

For simplicity, we will from now on refer to the nondimensional dependent variables from \ref{eqn:twomass_master_system} as \(h_1\) and \(h_2\),
and the nondimensional time variable $t$.

When examining individual cases, we often refer to the parameter quadruple \((\alpha,~\lambda,~\beta,~\omega)\), instead of listing each parameter individually.

\subsection{Strong coupling}

\begin{figure}
    \centering
    \includegraphics[width=\linewidth]{figures/twomass_equal_coupleosc.eps}
    \caption{Coupled oscillations under parameters \((1, 1, 3, 20)\) and initial conditions \(h_1 = 1.2, h_2 = 3.59\),
    with equilibrium positions \(1\) and \(3.7913\) respectively. The pair of masses, forced into different initial positions,
    equioscillate about each other rapidly, while following a dominant oscillation path.}
    \label{fig:twomass_dominant_osc}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[width=0.75\linewidth]{twomass_coupling_pillowplot}
    \caption{
        Plot of opposing displacements ($h_2$ against $h_1$). The motion is constrained within a fixed region,
        however it is quasiperiodic since the oscillations will, given infinite time, fill the entire illustrated area.
        Important parameters are \(\omega = 10, \lambda = 0.8\) so the stiffnesses are not equal and the masses are strongly constrained together.
    }
    \label{fig:twomass_quasiperiodic}
\end{figure} %MOVE THIS!!!!!

We study the behaviour of two strongly coupled masses of equal stiffness, represented by \( \alpha = 1,~\lambda = 1,~\omega \gggtr 1\).
The coupled system of equations in \ref{eqn:twomass_master_system} take the same form for each.
Similarly to the single-mass model, we can use the existence of stationary equilibria to determine the potential for oscillations to occur.
Imposing the existence of a stationary equilibrium solution \(h_1 = h_2 = x\) imposes that
\begin{equation}
    1 - x + \beta\left(
        1 - \frac{1}{x^2}
    \right) = 0,
\end{equation}
where the coupling term cancels.
The stable equilibria exist at the positive zeroes of the function we define:
\begin{equation}
    f(h) = 1 - h + \beta \left( 1 - \frac{1}{h^2} \right).
    \label{eqn:twomass_existence_of_equilibria}
\end{equation}
Existence of zeroes is equivalent to the local maximum, beloning at \(h = \left( 2\beta \right)^{1/3}\) being positive-valued such that the zeroes exist,
which can be written as
\begin{equation}
    1 - \left(2\beta\right)^\frac{1}{3} + \beta\left( 1 - (2\beta)^\frac{-2}{3} \right) \ge 0,
    \label{eqn:twomass_zeroes_equal_stiffness}
\end{equation}
with equality if there is only one equilibrium solution.
Equation \ref{eqn:twomass_zeroes_equal_stiffness} reduces to
\begin{equation}
    \frac{(1+\beta)^3}{\beta} \ge \frac{27}{4}.
\end{equation}
This is satisfied for all positive $\beta>0$ and has equality at $\beta = 0.5$.
If the initial conditions for \(h_1, h_2\) set their individual positions between the two equilibrium solutions,
provided they exist,
then we observe coupled oscillations as in Figure \ref{fig:twomass_dominant_osc}.
An important feature is that for \(\lambda = 1\), there exists a stationary stable equilibrium solution.
We will see later that this case is not satisfied elsewhere. %or is it
The equilibria, being the solutions of Equation \ref{eqn:twomass_existence_of_equilibria}, are identical for both components of the system of differential equations,
provided the parameters satisfy \(\alpha = 1, \lambda = 1, \omega \gggtr 1\) in order to model two strongly coupled masses.
This allows us to discuss the solutions to a single equation without loss of generality.
Assuming there exist equilibria \(x\), 
we can construct the Jacobian and determine the stability local to these equilibria.
We regard the whole system with the variable \(h_1=h_2=h\).
The system of derivatives in the single case can be written as

\begin{equation}
    \begin{aligned}
        \frac{\mathrm{d}h}{\mathrm{d}t} &= g \\
        \frac{\mathrm{d}g}{\mathrm{d}t} &= f(h) = 1-h +\beta\left(1-\frac{1}{h^2}\right),
    \end{aligned}
\end{equation}
which vectorises as

\begin{equation}
    \frac{\mathrm{d}}{\mathrm{d}t} \begin{pmatrix}
        h \\
        g
    \end{pmatrix} = \begin{pmatrix}
        g \\
        f(h)
    \end{pmatrix}.
\end{equation}
Recall we have stationary equilibria which we call \(x\). Compute the taylor series of \(f(h)\) local to this point.

\begin{equation}
    f(h) = f(x) + (h-x)f'(x) + (h-x)^2\frac{f''(x)}{2!} + \mathellipsis =\sum_{0}^{\infty} (h-x)^n\frac{f^{(n)}(x)}{n!}.
\end{equation}
Similarly to our earlier reasoning, we truncate the Taylor series to the approximation $f(h) \approx (h-x)f'(x)$.
The vectorised approximation becomes

\begin{equation}
    \frac{\mathrm{d}}{\mathrm{d}t}\begin{pmatrix}
        h \\
        g
    \end{pmatrix} = \begin{pmatrix}
        g \\
        (h-x)f'(x)
    \end{pmatrix}.
\end{equation}
Substituting \(U = h-x\) and \(V = g\) we obtain

\begin{equation}
    \frac{\mathrm{d}}{\mathrm{d}t} \begin{pmatrix}
        U \\
        V
    \end{pmatrix} = \begin{bmatrix}
        0 & 1 \\
        f'(x) & 0
    \end{bmatrix} \begin{pmatrix}
        U \\
        V
    \end{pmatrix} 
\end{equation}
We can inspect the eigenvalues of this matrix to determine the stability of the equilibrium solutions. %so do it
Coming from the original model, we would expect three cases in which we can analyse equilibria, being

%EIGENVALUES HERE PLEASE

\begin{enumerate}
    \item There are no equilibrium solutions and oscillations never occur,
    \item There is one equilibrium solution and oscillations do not occur,
    \item There are two equilibrium solutions and oscillations may occur about a stable stationary point.
\end{enumerate} %more on this

The cases in this model are reduced, since the stationary point $1$ is always a solution for any value of \(\beta\).
Hence there can be one or two stationary points.
The single solution exists in the case of equality in Equation \ref{eqn:twomass_zeroes_equal_stiffness}.


%it gets rough from here

\subsection{Weak coupling}

\begin{figure}
    \centering
    \includegraphics[width=\linewidth]{twomass_individual_converging}
    \caption{
        Parameters given are \((1, 0.8, 3, 1)\). The masses oscillate near independently starting at different positions $(1.96, 0.83)$ at time $t=0$.
        The figures, left to right, progressively increase the time we run the computation.
        We can see in the left-most plot that the weak coupling leads to the masses oscillating at independent frequencies.
        As running time increases, the masses converge to their own equilibrium positions.
        }
    \label{fig:twomass_independent}
\end{figure}
We now develop our analysis of the two mass model by examining multiple dimensions of the parameter space.
First, we will retain the stiffness coupling \(\omega \gggtr 1\),
but consider the cases induced by \(\lambda \ne 1\), which are where the relative stiffnesses for each component are not the same.
We freely change \(\beta\) since it is similar to a forcing term, which we can change to observe different behaviours of the model.

If we impose \(\omega \llless 1\), we expect both masses to act near independently.
We can see in figure \ref{fig:twomass_independent} that this is mostly the case, since oscillations occur with apparent independence.
However the oscillations converge, gradually decreasing in amplitude and increasing in wavelength.


\subsection{Intermediate coupling force, equilibria}

In general, we observe quasiperiodic oscillating motion of the masses.
We will clarify the behaviours that we would expect the coupled system to exhibit.
Firstly, the masses may oscillate indefinitely within a bounded region.
A trivial subclass of this behaviour would be the masses resting in a stationary equilibrium.
Alternatively, we could experience closure, with or without oscillations beforehand.

Figure \ref{fig:twomass_quasiperiodic} demonstrates indefinite oscillations under a high coupling force. 
The borders of the shape accommodate the restrictions of the coupling force,
and the individual stiffness of the masses.

We would expect the equilibria instead to be the solutions of two equations for each component, being:

\begin{equation}
    \begin{aligned}
        \hat{f}_1(h) &= 1 - h + \beta\left( 1-\frac{1}{h^2} \right) &= 0 \\
        \hat{f}_2(h) &= \lambda(1-h) + \beta\left( 1-\frac{1}{h^2} \right) &= 0.
    \end{aligned}
    \label{eqn:twomass_coupled_equilibria_uncoupled}
\end{equation}
We have neglected the \(\alpha\) term in this case since it is a scaling of the second equation and is never $0$,
so a zero of \(\hat{f_2}\) works regardless of the value of \(\alpha\).
The existence of equilibrium solutions is expected to be determined by two assumptions, being
\begin{align*}
    f_1 \left( (2\beta)^\frac{1}{3} \right) &\ge 0, \\
    f_2 \left( \left( \frac{2\beta}{\lambda} \right)^\frac{1}{3} \right) &\ge 0,
\end{align*}
where if both are satisfied, then each mass has two points in space where it belongs to a state of stationary equilibrium.
However, note the assumption that \(h_1=h_2\) which we made when exploring earlier cases,
which is no longer a valid assumption to make. 
Therefore, we cannot neglect the stiffness coupling term,
which makes it much harder to determine potential points of equilibrium of the system.
We will refer to the solutions of Equation \ref{eqn:twomass_coupled_equilibria_uncoupled} as the \textit{particular equilibria},
while the actual solutions to the coupled equations will be referred to as the \textit{general equilibria}.
If we are to define the properties of stationary equilibria more rigorously,
we will be able to understand the properties of the model better.
\begin{figure}
    \centering
    \includegraphics[width=\linewidth]{twomass_families_equilibria}
    \caption{
        Curves A (left), B(middle), C (right), representing the equilibrium solutions to the coupled equations under separate parameters.
        The $x$ and $y$ axes are the equilibrium solutions of $f_1 = 0$ and $f_2=0$ respectively. 
        In all graphs, the blue curve is the family of all equilibrium solutions for $x$,
        the red curve is the family of solutions for $y$,
        and the green line is the line $y=x$.
        Curves A, B and C all feature parameters \(\alpha = 1,~\lambda=0.8,~\omega = 0.5\), changing $\beta$,
        where \(\beta_\mathrm{A} = 4,~\beta_\mathrm{B} = 2,~\beta_\mathrm{C} = 0.8\)
        The red and blue curves intersect at points $f_1=f_2=0$,
        which are equilibrium solutions satisfying both equations.
        The points at which a curve intersects the $y=x$ line are the points that satisfy equilibrium of that equation, and also satisfy $y=x$,
        which cancels the coupling term.
        These are the solutions of $\hat{f_1}=\hat{f_2}=0$ which we covered earlier.
        Negative solutions do exist but must be ignored since we cannot accommodate negative values for $h_1, h_2$ in the model.
    }
    \label{fig:twomass_equilibrium_curves}
\end{figure}
We want all equilibrium solutions \(h_1 = x, h_2 = y\) which solve the coupled differential equations.
From here on, an equilibrium solution is a pair \((h_1,h_2)\).
Make the definition
\begin{equation}
    \begin{aligned}
        f_1(x,y) &= 1-x + \beta\left(1 - \frac{1}{x^2}\right) + \omega(y-x) \\
        f_2(x,y) &= \lambda(1-y) + \beta\left(1 - \frac{1}{y^2}\right) + \omega(x-y)
        \label{eqn:twomass_equilibrium_functions}
    \end{aligned}
\end{equation}
Then the system we are solving can be written as
\begin{equation}
    \begin{aligned}
        \frac{\mathrm{d}^2x}{\mathrm{d}t^2} = f_1(x,y) \\
        \alpha\frac{\mathrm{d}^2y}{\mathrm{d}t^2} = f_2(x,y)
        \label{eqn:twomass_slave}  
    \end{aligned}
\end{equation}
and we want to solve for equilibrium solutions. It suffices to solve \(f_1(x,y) = f_2(x,y) = 0\) to generate equilibrium solutions,
since \(\alpha\) only changes the equation up to scaling. 
An equilibrium solution is now a pair \((x,y)\) which solve both equations,
thus the problem can be reduced to
\begin{equation}
    1-x + \beta\left(1 - \frac{1}{x^2}\right) + \omega(y-x) = \lambda(1-y) + \beta\left(1 - \frac{1}{y^2}\right) + \omega(x-y) = 0.
    \label{eqn:twomass_noalpha_equilibrium_solutions}
\end{equation}
Our solutions are determined by two non-linear homogeneous equations involving three parameters \((\lambda, \beta, \omega)\), which we want to solve for two variables \((x,y)\).
This is a challenge to solve, but to start we know from the formulation of the model and the nondimensionalisation that \((x,y) = (1,1)\) is an equilibrium solution for all values of the parameters.
Solutions are found by computation via. Newton's method.
Figure \ref{fig:twomass_equilibrium_curves} visualises the families of solutions to the equations.
The iterative method starts by using Newton's method to solve the separated equations, negligent of the stiffness coupling.
These individual stationary points are used for a second implementation of Newton's method solving a homogeneous equation of a vector function \(F = [f_1, f_2]^\mathrm{T}\).
This computes an equilibrium pair \((x,y)\), which solves the coupled equations. % IT TOOK 2 DAYS
In most cases, there are four individual equilibrium solution pairs to the coupled equations,
being the strictly positive intersection points of the hyperbolas in Figure \ref{fig:twomass_equilibrium_curves}.
The negative regions are included in the figure for visualisation of the shape of the curves,
but the negative-valued solutions are invalid forms of equilibrium for our formulation of the problem.
We will refer to the solution pairs close to the line $y=x$ as the \textit{diagonal equilibria},
and the other solutions as the \textit{off-diagonal equilibria}.
On inspection, as the extrema of the curves approach each other,
the off-diagonal equilibria annihilate.

Solutions to Equation \ref{eqn:twomass_noalpha_equilibrium_solutions} can fortunately be computed to any accuracy we require,
however an important question involves the existence of solutions themselves.
We want to know, depending on the parameters, how many solutions exist.
The equations themselves can be arranged into the couple,
\begin{equation}
    \begin{aligned}
        (\omega + \lambda)y^3 - (\lambda + \beta)y^2 - \omega x y^2 + \beta &= 0 \\
        (1 + \lambda)x^3 - (1 + \beta)x^2 - \omega y x^2 + \beta &= 0.
    \end{aligned}
\end{equation}
where each equation is linear in one variable and polynomial (a nicer form of non-linear) in the other.
Rearrange the equation linear in $x$ to write it in terms of $y$ and then substitute back to obtain
\begin{equation}
    (1+\omega)\left( \left( 1 + \frac{\lambda}{\omega}y \right) + \frac{\beta}{\omega y^2} - \frac{\lambda + \beta}{\omega}\right)^3 - (1+\beta+\omega y)\left( \left( 1 + \frac{\lambda}{\omega}y \right) + \frac{\beta}{\omega y^2} - \frac{\lambda + \beta}{\omega}\right)^2 + \beta = 0.
    \label{eqn:twomass_equilibria_polynomial}
\end{equation}
However we have to keep in mind the requirements on the variables.
We must have that all parameters \(\lambda,~\beta,~\omega\) are strictly positive, and likewise for \(x\) and \(y\).
Since we have eliminated $x$, we have actually gained solutions, since it is possible for a solution to exist for a positive $y$ and negative $x$, which is a solution for this equation.
We require the polynomial term to be strictly positive as a qualification for solutions. %%work on this

We want to evaluate the stability of the equilibrium solutions for the two mass model.
We first truncate the Taylor series of \(f_1\) and \(f_2\) about an equilibrium point \((x_0,y_0)\) to the first order approximation, yielding the equations
\begin{equation}
    \begin{aligned}
        \frac{\mathrm{d}^2x}{\mathrm{d}t^2} &= f_1(x_0,y_0) + \left(\frac{\partial f_1}{\partial x}(x_0,y_0)\right)(x-x_0) + \left(\frac{\partial f_1}{\partial y}(x_0,y_0)\right)(y-y_0) \\
        \frac{\mathrm{d}^2y}{\mathrm{d}t^2} &= f_2(x_0,y_0) + \left(\frac{\partial f_2}{\partial x}(x_0,y_0)\right)(x-x_0) + \left(\frac{\partial f_2}{\partial y}(x_0,y_0)\right)(y-y_0).
    \end{aligned}
\end{equation}
The constant terms vanish by the definition of the equilibrium solutions. Introduce \(u = x-x_0,~v=y-y_0\). The system becomes
\begin{equation}
    \begin{aligned}
        \frac{\mathrm{d}^2u}{\mathrm{d}t^2} &= \left(\frac{\partial f_1}{\partial x}(x_0,y_0)\right)u + \left(\frac{\partial f_1}{\partial y}(x_0,y_0)\right)v \\
        \frac{\mathrm{d}^2v}{\mathrm{d}t^2} &= \left(\frac{\partial f_2}{\partial x}(x_0,y_0)\right)u + \left(\frac{\partial f_2}{\partial y}(x_0,y_0)\right)v.
    \end{aligned}
\end{equation}
Now introduce the variables $\hat{u},~\hat{v}$ such that \(\mathrm{d}u/\mathrm{d}t = \hat{u}\) and \(\mathrm{d}v/\mathrm{d}t = \hat{v}\). This formulates the linear system:
\begin{equation}
    \begin{aligned}
        \frac{\mathrm{d}u}{\mathrm{d}t} &= \hat{u} \\
        \frac{\mathrm{d}\hat{u}}{\mathrm{d}t} &= \left(\frac{\partial f_1}{\partial x}(x_0,y_0)\right)u + \left(\frac{\partial f_1}{\partial y}(x_0,y_0)\right)v \\
        \frac{\mathrm{d}v}{\mathrm{d}t} &= \hat{v} \\
        \frac{\mathrm{d}\hat{v}}{\mathrm{d}t} &= \left(\frac{\partial f_2}{\partial x}(x_0,y_0)\right)u + \left(\frac{\partial f_2}{\partial y}(x_0,y_0)\right)v.
    \end{aligned}
\end{equation}
We have obtained the Jacobian for the system, appearing in the matrix equation:
\begin{equation}
    \frac{\mathrm{d}}{\mathrm{d}t} \begin{pmatrix}
        u \\
        \hat{u} \\
        v \\
        \hat{v}
    \end{pmatrix} = \begin{bmatrix}
        0 & 1 & 0 & 0 \\
        \frac{\partial f_1}{\partial x}(x_0,y_0) & 0 & \frac{\partial f_1}{\partial y}(x_0,y_0) & 0 \\
        0 & 0 & 0 & 1 \\
        \frac{\partial f_2}{\partial x}(x_0,y_0) & 0 & \frac{\partial f_2}{\partial y}(x_0,y_0) & 0 \\
    \end{bmatrix} \begin{pmatrix}
        u \\
        \hat{u} \\
        v \\
        \hat{v}
    \end{pmatrix}.
    \label{eqn:twomass_matrix_jacobian_quad}
\end{equation}

In prior examples, the problems have involved second order systems,
whereas our current problem is fourth order,
hence the \(4\times4\) matrix \(\mathbf{J}\).






%\subsection{Oscillations and closure}

\subsection{Analysing a non-linear dynamics problem}

\begin{figure}
    \centering
    \includegraphics[width = 0.6\linewidth]{figures/twomass_first_poincare.eps}
    \caption{
        Time series and Poincar\'e map of a converging oscillation.
        On the left, we see that the oscillations slowly decrease in magnitude, orbiting the stationary point,
        and on the right we see the Poincar\'e map representing velocity on intersection with the line $h_1 = h_1()\mathrm{equilibrium}$.
        The veloctity follows a dominant path over the time period of the computation.
        The fluctuation around the dominant velocity indicates that the oscillations are quasiperiodic.
    }
    \label{fig:twomass_first_poincare}
\end{figure}

Because the form of the problem is fourth order,
the problem can be analysed as the behaviour of an obejct in four dimensions.
Furthermore, the parameter space is also four dimensional.
The methods in which we represent solutions graphically are simplifications,
where the four-dimensional behaviour is projected onto a two-dimensional image.

The Poincar\'e section of an $N$ dimensional space is a subspace of dimension at most $N-1$,
often used in analysis of dynamical systems. We can construct a particular Poincar\'e section,
and then record data when the object intersects with the subspace.
The Poincar\'e map is the representation of the behaviour of the object over time,
only during its intersection with the Poincar\'e section.
We can use the Poincar\'e map generated by particular instances of the model in order to identify periodic and quasiperiodic motion, as well as chaos.
See Figure \ref{fig:twomass_first_poincare}, which visualises the Poincar\'e map in a simple case.

\subsection{A collection of results}

General equilibrium solutions are not affected by the mass quotient $\alpha$, so in most cases $\alpha = 1$ for simplicity.

\dots

We give numerical results to two decimal places for simplicity.

\dots

Consider the parameter configuration \((1,~0.8,~3,~0.3)\), where we have a difference in stiffness and a lower stiffness coupling.
There are four equilibrium solutions.
The diagonal equilibria are \((1,1)\) and \((3.94,4.39)\),
and the off-diagonal equilibria are \((0.88,3.47)\) and \((3.03,0.90)\).
With the Jacobian as in Equation \ref{eqn:twomass_matrix_jacobian_quad},
the diagonal solution \((1,1)\) has entirely real eigenvalues, and \((3.94,4.39)\) has entirely imaginary eigenvalues.
Each off-diagonal solution has a combination, with one pair of eigenvalues being entirely imaginary and the other being entirely real.


\subsection{Verification of results}

Recall the equations of motion which are given by Equation \ref{eqn:twomass_master_system}
We want to rearrange these equations and integrate, similar to what we did in the previous section, in order to find an expression that resembles the kinetic energy of the system.
First, we will write \(u = h_1,~v=h_2\) for convenience, and express the equations of motion in the form
\begin{align*}
    \frac{\mathrm{d}^2 u}{\mathrm{d}t^2} &= 1 - u + \beta\left(1-\frac{1}{u^2}\right) + \omega(v-u) \\
    \alpha\frac{\mathrm{d}^2 v}{\mathrm{d}t^2} &= \lambda(1 - v) + \beta\left(1-\frac{1}{v^2}\right) + \omega(u-v).
\end{align*}
Define functions $\hat{f}$ and $\hat{g}$ as follows
\begin{align*}
    \hat{f}(u) &= 1-u + \beta\left(1-\frac{1}{u^2}\right) \\
    \hat{g}(v) &= \lambda(1-v) + \beta\left( 1-\frac{1}{v^2} \right).
\end{align*}
Now define functions $F$ and $G$
\begin{align*}
    F(u) &= u - \frac{1}{2}u^2 + \beta\left(u - \frac{1}{u} \right) \\
    G(u) &= \lambda\left( v - \frac{1}{2}v^2 \right) + \beta\left( v - \frac{1}{v}\right).
\end{align*}
These functions satisfy \(\mathrm{d}F/\mathrm{d}u = \hat{f}(u)\) and \(\mathrm{d}G/\mathrm{d}v = \hat{g}(v)\).
We can write the system of differential equations in the form
\begin{align*}
    \frac{\mathrm{d}^2 u}{\mathrm{d}t^2} = \hat{f}(u) + \omega(v-u) \\
    \alpha\frac{\mathrm{d}^2 v}{\mathrm{d}t^2} = \hat{g}(v) + \omega(u-v).
\end{align*}
We will perform a rearranging of the expression on the second derivative of $u$,
but we will not go into detail on the derivation for the second expression,
since it is virtually identical.
First, we multiply the whole equation by the first derivative of $u$ with respect to $t$,
\begin{equation*}
    \frac{\mathrm{d}u}{\mathrm{d}t}\frac{\mathrm{d}^2 u}{\mathrm{d}t^2} = \frac{\mathrm{d}u}{\mathrm{d}t}\hat{f}(u) + \omega \frac{\mathrm{d}u}{\mathrm{d}t}(v-u).
\end{equation*}
This expression can be written mostly as derivatives, equivalently as
\begin{equation*}
    \frac{\mathrm{d}}{\mathrm{d}t}\left(
        \frac{1}{2}\left(\frac{\mathrm{d}u}{\mathrm{d}t}\right)^2
     \right) = \frac{\mathrm{d}}{\mathrm{d}t}F(u) - \omega\frac{\mathrm{d}}{\mathrm{d}t}\left(\frac{1}{2}u^2\right) + \omega v \frac{\mathrm{d}u}{\mathrm{d}t}.
\end{equation*}
Applying the same method to the second equation, we obtain
\begin{equation*}
    \frac{\mathrm{d}}{\mathrm{d}t}\left(
        \frac{1}{2}\alpha\left(\frac{\mathrm{d}v}{\mathrm{d}t}\right)^2
    \right) = \frac{\mathrm{d}}{\mathrm{d}t}G(v) - \omega\frac{\mathrm{d}}{\mathrm{d}t}\left( \frac{1}{2}v^2 \right) + \omega u \frac{\mathrm{d}v}{\mathrm{d}t}.
\end{equation*}
We would like to take the differential operator out of all the terms, but there are still mixed terms of $u$ and $v$ that make this difficult.
However, if we take the differential operator out of all the terms where we can, and ignore the mixed terms, we can add both expressions and obtain
\begin{equation*}
    \frac{\mathrm{d}}{\mathrm{d}t}\left(
        \frac{1}{2}\left(\frac{\mathrm{d}u}{\mathrm{d}t}\right)^2 + \frac{1}{2}\alpha\left(\frac{\mathrm{d}u}{\mathrm{d}t}\right)^2
    \right) = \frac{\mathrm{d}}{\mathrm{d}t}\left(
        F(u) + G(v) - \frac{\omega}{2}u^2 -\frac{\omega}{2}v^2
    \right) + \omega \left(
        u \frac{\mathrm{d}v}{\mathrm{d}t} + \frac{\mathrm{d}u}{\mathrm{d}t}v
    \right)
\end{equation*}
In adding both expressions, the mixed terms add together and form an integrable expression.
The expansion is given here:
\begin{equation*}
    \frac{\mathrm{d}}{\mathrm{d}t}(\omega uv) = \omega \left( u \frac{\mathrm{d}v}{\mathrm{d}t} + \frac{\mathrm{d}u}{\mathrm{d}t} v \right)
\end{equation*}
Hence the whole expression under the differential operator can be written as
\begin{equation*}
    \frac{\mathrm{d}}{\mathrm{d}t}\left(
        \frac{1}{2}\left(\frac{\mathrm{d}u}{\mathrm{d}t}\right)^2 + \frac{1}{2}\alpha\left(\frac{\mathrm{d}u}{\mathrm{d}t}\right)^2
    \right) = \frac{\mathrm{d}}{\mathrm{d}t}\left(
        F(u) + G(v) - \frac{\omega}{2}u^2 -\frac{\omega}{2}v^2 + \omega uv
    \right) 
\end{equation*}
and if we integrate the expression, and rearrange slightly, we obtain
\begin{equation}
    \frac{1}{2}\left(
        \left(\frac{\mathrm{d}u}{\mathrm{d}t}\right)^2 + \left(\frac{\mathrm{d}v}{\mathrm{d}t}\right)^2
    \right) = F(u) + G(v) - \frac{\omega}{2}(u-v)^2 + C.
    \label{eqn:twomass_energy_constant}
\end{equation}
This equation gives us an expression on the values \(u,~v,~\mathrm{d}u/\mathrm{d}t\) and \(\mathrm{d}v/\mathrm{d}t\),
which are the values we compute solutions of, and relates them to a constant $C$.
Since the constant is unchanging in time, we can use it to verify that a computed solution is reliable,
by evaluating $C$ at multiple points in the time span of the computation.

%\subsection{The motivation: voiced sounds}


\end{document}

